*** Begin Patch
*** Update File: SPT/lib/train/data/loader.py
@@
-        return torch.stack(batch, 1, out=out)
+        try:
+            return torch.stack(batch, 1, out=out)
+        except RuntimeError:
+            max_len = max(t.shape[0] for t in batch)
+            aligned = []
+            for tensor in batch:
+                if tensor.shape[0] == max_len:
+                    aligned.append(tensor)
+                else:
+                    pad_shape = (max_len,) + tensor.shape[1:]
+                    padded = tensor.new_zeros(pad_shape)
+                    padded[:tensor.shape[0]] = tensor
+                    aligned.append(padded)
+            return torch.stack(aligned, 1)
*** End Patch
